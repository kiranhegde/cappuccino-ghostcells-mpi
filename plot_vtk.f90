      subroutine plot_3D_field_vtk ( iof, io_file, io_case, io_format, file_title, data_name,&
                               Ni, Nj, Nk, istep, jstep, kstep,&
                               x, y, z, f, g, h)
!===================================================================================================================================
!=====                                                       =======================================================================
!=====subroutine :  PT3D1A                                   =======================================================================
!=====function   :  output routine for plot interface  with  =======================================================================
!=====              EXPLORER for plotting a 3-D field        =======================================================================
!=====arguments  :  iof    : output unit                     =======================================================================
!=====                       (integer scalar)                =======================================================================
!=====                       (input)                         =======================================================================
!=====              iofile : name of unit iof file           =======================================================================
!=====                       (character)                     =======================================================================
!=====                       (input)                         =======================================================================
!=====              io_case  : output choice                 =======================================================================
!=====                       if io_case = 'scalar'           =======================================================================
!=====                       if io_case = 'vector'           =======================================================================
!=====                       (character)                     =======================================================================
!=====                       (input)                         =======================================================================
!=====              io_format : for now only 'vtk'           =======================================================================
!=====                         (character)                   =======================================================================
!=====                         (input)                       =======================================================================
!=====              file_title: appears in the               =======================================================================
!=====                          file header                  =======================================================================
!=====                         (character)                   =======================================================================
!=====                         (input)                       =======================================================================
!=====              data_name: what data is written          =======================================================================
!=====                       (character)                     =======================================================================
!=====                       (input)                         =======================================================================
!=====              NI     : number of points i-wise         =======================================================================
!=====                       (integer scalar)                =======================================================================
!=====                       (input/output)                  =======================================================================
!=====              NJ     : number of points j-wise         =======================================================================
!=====                       (integer scalar)                =======================================================================
!=====                       (input/output)                  =======================================================================
!=====              NK     : number of points k-wise         =======================================================================
!=====                       (integer scalar)                =======================================================================
!=====                       (input/output)                  =======================================================================
!=====              ISTEP  : i-wise vector-storage-step      =======================================================================
!=====                       (integer scalar)                =======================================================================
!=====                       (input/output)                  =======================================================================
!=====              JSTEP  : j-wise vector-storage-step      =======================================================================
!=====                       (integer scalar)                =======================================================================
!=====                       (input/output)                  =======================================================================
!=====              KSTEP  : k-wise vector-storage-step      =======================================================================
!=====                       (integer scalar)                =======================================================================
!=====                       (input/output)                  =======================================================================
!=====              X      : x-wise coordinate               =======================================================================
!=====                       (real vector dim NI*NJ*NK)      =======================================================================
!=====                       (input/output)                  =======================================================================
!=====              Y      : y-wise coordinate               =======================================================================
!=====                       (real vector dim NI*NJ*NK)      =======================================================================
!=====                       (input/output)                  =======================================================================
!=====              Z      : z-wise coordinate               =======================================================================
!=====                       (real vector dim NI*NJ*NK)      =======================================================================
!=====                       (input/output)                  =======================================================================
!=====              F      : function value                  =======================================================================
!=====                       (real vector dim NI*NJ*NK)      =======================================================================
!=====                       (input/output)                  =======================================================================
!===================================================================================================================================
!
!-character-------------------------------------------------------------
  character(len=  *)                            :: io_file
  character(len=  *)                            :: io_case
  character(len=  *)                            :: io_format
  character(len=  *)                            :: file_title
  character(len=  *)                            :: data_name
!-real------------------------------------------------------------------
!
!-----------------------------------------------------------------------
  real*8              , dimension(*)              :: x
  real*8              , dimension(*)              :: y
  real*8              , dimension(*)              :: z

  real*8              , dimension(*)              :: f
  real*8              , dimension(*)              :: g
  real*8              , dimension(*)              :: h

  integer                                       :: Ni, Nj, Nk
!
!-----------------------------------------------------------------------
!-----------------------------------------------------------------------
!-vtk-------------------------------------------------------------------
!-----------------------------------------------------------------------
!-----------------------------------------------------------------------
  if ( trim(io_format) == 'vtk' ) then!-------------------------------------------------------------------------------------------
!-----------------------------------------------------------------------                                                          !   
  if (trim(io_case) == 'scalar') then                                                                                             !
                                       open (unit=iof,file=trim(io_file)//'.vtk'); rewind (unit=iof)!---------------------------  !
                                       write(unit=iof,fmt='(a)') '# vtk DataFile Version 2.0'                                   ! !
                                       write(unit=iof,fmt='(a)') trim(file_title)                                               ! !
                                       write(unit=iof,fmt='(a)') 'ASCII'                                                        ! !
                                       write(unit=iof,fmt='(a)') 'DATASET STRUCTURED_GRID'                                      ! !
                                       write(unit=iof,fmt='(a,1x,i14,1x,i14,1x,i14)')'DIMENSIONS',Ni, Nj, Nk                    ! !
                                       write(unit=iof,fmt='(a,1x,i14,1x,a)') 'POINTS', Ni*Nj*Nk, 'float'                        ! !
                                       do  k = 1, Nk, kstep; do  j = 1, Nj, jstep; do  i = 1, Ni, istep                         ! !
                                       n=(K-1)*NI*NJ+(I-1)*NJ+J                                                                 ! !
!                                       n=1+(i-1)*istep+(j-1)*jstep+(k-1)*kstep                                                 ! !
                                       write(unit=iof,fmt='(3(1x,e23.13e3))') x(n), y(n), z(n); end do; end do; end do          ! !
                                       write(unit=iof,fmt='(a,1x,i14)')'POINT_DATA', Ni*Nj*Nk                                   ! !
                                       write(unit=iof,fmt='(3(a,1x),i14)')'SCALARS', data_name, 'float', 1                      ! !
                                       write(unit=iof,fmt='(a)') 'LOOKUP_TABLE default'                                         ! !
                                       do  k = 1, Nk, kstep; do  j = 1, Nj, jstep; do  i = 1, Ni, istep!-----------------       ! !
                                       n=(K-1)*NI*NJ+(I-1)*NJ+J                                                          !      ! !
!                                       n=1+(i-1)*istep+(j-1)*jstep+(k-1)*kstep                                          !      ! !
                                       write(unit=iof,fmt='(e23.13e3)') f(n); end do; end do; end do!<-------------------       ! !
                                       close(unit=iof)        !<----------------------------------------------------------------  !
                                                                                                                                  !
  else if (trim(io_case) == 'vector') then                                                                                        !
                                                                                                                                  !
                                       open (unit=iof,file=trim(io_file)//'.vtk'); rewind (unit=iof)!---------------------------  !
                                       write(unit=iof,fmt='(a)') '# vtk DataFile Version 2.0'                                   ! !
                                       write(unit=iof,fmt='(a)') trim(file_title)                                               ! !
                                       write(unit=iof,fmt='(a)') 'ASCII'                                                        ! !
                                       write(unit=iof,fmt='(a)') 'DATASET STRUCTURED_GRID'                                      ! !
                                       write(unit=iof,fmt='(a,1x,i14,1x,i14,1x,i14)')'DIMENSIONS',Ni, Nj, Nk                    ! !
                                       write(unit=iof,fmt='(a,1x,i14,1x,a)') 'POINTS', Ni*Nj*Nk, 'float'                        ! !
                                       do  k = 1, Nk, kstep; do  j = 1, Nj, jstep; do  i = 1, Ni, istep                         ! !
                                       n=(K-1)*NI*NJ+(I-1)*NJ+J                                                                 ! !
!                                       n=1+(i-1)*istep+(j-1)*jstep+(k-1)*kstep                                                 ! !
                                       write(unit=iof,fmt='(3(1x,e23.13e3))') x(n), y(n), z(n); end do; end do; end do          ! !
                                       write(unit=iof,fmt='(a,1x,i14)')'POINT_DATA', Ni*Nj*Nk                                   ! !
!                                       write(unit=iof,fmt='(3(a,1x),i14)')'SCALARS', data_name, 'float', 1                     ! !
!                                       write(unit=iof,fmt='(a)') 'LOOKUP_TABLE default'                                        ! !
                                       write(unit=iof,fmt='(3(a,1x),i14)')'VECTORS', data_name, 'float'                         ! !
                                       do  k = 1, Nk, kstep; do  j = 1, Nj, jstep; do  i = 1, Ni, istep!-----------------       ! !
                                       n=(K-1)*NI*NJ+(I-1)*NJ+J                                                            !    ! !
!                                      n=1+(i-1)*istep+(j-1)*jstep+(k-1)*kstep                                             !    ! !
                                       write(unit=iof,fmt='(3(1x,e23.13e3))'), f(n), g(n), h(n); end do; end do; end do!<--     ! !
                                       close(unit=iof)        !<----------------------------------------------------------------  !
                                                                                                                                  !
  end if! scalar or vector field                                                                                                  !
  end if!<-vtk--------------------------------------------------------------------------------------------------------------------

  return
  end
